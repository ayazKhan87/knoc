<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knoc - Find Products Nearby</title>

    <!-- Meta Description -->
    <meta name="description" content="Knoc helps you instantly find products nearby. Discover items in local stores around you ‚Äî just Knoc.">
    
    <!-- Open Graph Tags -->
    <meta property="og:title" content="Knoc - Find Products Nearby" />
    <meta property="og:description" content="Knoc connects you with products in local stores. Discover what's nearby instantly." />
    <meta property="og:url" content="https://www.knoc.in" />
    <meta property="og:type" content="website" />
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Knoc - Find Products Nearby" />
    <meta name="twitter:description" content="Knoc helps you instantly find local products near you." />
    
    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Knoc",
      "url": "https://www.knoc.in",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://www.knoc.in/?s={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>

    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- GSAP for animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #0a0a0a;
            color: white;
            overflow-x: hidden;
        }

        /* Animated gradient background */
        .animated-gradient {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 25%, #2d1b1b 50%, #1a1a1a 75%, #0a0a0a 100%);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
            min-height: 100vh;
            position: relative;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            25% { background-position: 100% 50%; }
            50% { background-position: 100% 100%; }
            75% { background-position: 0% 100%; }
            100% { background-position: 0% 50%; }
        }

        /* Navigation */
        .nav-glass {
            backdrop-filter: blur(20px);
            background: rgba(10, 10, 10, 0.8);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 70px;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo {
            width: 48px;
            height: 48px;
            border-radius: 16px;
            background: linear-gradient(135deg, #ef4444, #dc2626);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }

        .logo-text {
            font-size: 24px;
            font-weight: bold;
            color: white;
        }

        /* Compact Hero Section - Mobile Optimized */
        .hero-section {
            min-height: 75vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 100px 20px 40px;
            text-align: center;
            position: relative;
            z-index: 10;
        }

        .hero-content {
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
        }

        .hero-title {
            font-size: 3rem;
            font-weight: bold;
            line-height: 1.2;
            margin-bottom: 16px;
        }

        .hero-subtitle {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 32px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.5;
        }

        .gradient-text {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Compact Search Section */
        .search-section {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            border: 1px solid rgba(239, 68, 68, 0.1);
            padding: 32px 24px;
            margin: 32px 0;
            position: relative;
        }

        .search-label {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(239, 68, 68, 0.2);
            padding: 6px 14px;
            border-radius: 16px;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 20px;
            color: white;
        }

        /* Enhanced search box */
        .search-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
        }

        .search-box {
            position: relative;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(30px);
            border-radius: 20px;
            padding: 16px 50px 16px 20px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .search-box:focus-within {
            border-color: #ef4444;
            box-shadow: 0 0 30px rgba(239, 68, 68, 0.3), 0 8px 32px rgba(0, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.15);
        }

        .search-input {
            width: 100%;
            background: transparent;
            border: none;
            outline: none;
            color: white;
            font-size: 16px;
            font-weight: 500;
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .search-icon {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.6);
            transition: color 0.3s ease;
        }

        .search-box:focus-within .search-icon {
            color: #ef4444;
        }

        /* Category indicator */
        .category-indicator {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(239, 68, 68, 0.2);
            backdrop-filter: blur(20px);
            padding: 6px 16px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 600;
            opacity: 0;
            transition: all 0.3s ease;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .category-indicator.active {
            opacity: 1;
            transform: translateX(-50%) translateY(-8px);
        }

        /* Suggestions dropdown */
        .suggestions-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            margin-top: 8px;
            max-height: 350px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            display: none;
        }

        .suggestions-dropdown.show {
            display: block;
        }

        .suggestion-item {
            padding: 12px 16px;
            cursor: pointer;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.2s ease;
        }

        .suggestion-item:hover,
        .suggestion-item.selected {
            background: rgba(239, 68, 68, 0.1);
            border-left: 3px solid #ef4444;
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        /* Typing indicator */
        .typing-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 12px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 13px;
        }

        .typing-dots {
            display: flex;
            margin-left: 8px;
        }

        .typing-dot {
            width: 3px;
            height: 3px;
            border-radius: 50%;
            background: #ef4444;
            margin: 0 2px;
            animation: typingDot 1.5s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typingDot {
            0%, 60%, 100% { transform: scale(0.8); opacity: 0.5; }
            30% { transform: scale(1.2); opacity: 1; }
        }

        /* Quick Action Buttons */
        .quick-actions {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin: 24px 0 16px;
            flex-wrap: wrap;
        }

        .btn-primary {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border: none;
            border-radius: 16px;
            padding: 10px 20px;
            font-weight: 600;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
            box-shadow: 0 4px 20px rgba(239, 68, 68, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(239, 68, 68, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 10px 20px;
            font-weight: 600;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
            backdrop-filter: blur(20px);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        /* Featured Shops Section - Optimized for Mobile */
        .featured-shops-section {
            padding: 40px 20px 60px;
            position: relative;
        }

        .featured-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .section-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .section-title {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 8px;
            color: white;
        }

        .section-subtitle {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 24px;
        }

        .category-filters {
            display: flex;
            gap: 8px;
            justify-content: flex-start;
            overflow-x: auto;
            padding: 0 0 12px 0;
            margin-bottom: 24px;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .category-filters::-webkit-scrollbar {
            display: none;
        }

        .category-filter {
            padding: 6px 14px;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 13px;
            font-weight: 500;
            backdrop-filter: blur(20px);
            white-space: nowrap;
            flex-shrink: 0;
        }

        .category-filter:hover,
        .category-filter.active {
            background: rgba(239, 68, 68, 0.2);
            border-color: #ef4444;
            color: white;
        }

        .featured-shops-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
        }

        .featured-shop-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .featured-shop-card:hover {
            transform: translateY(-4px);
            border-color: rgba(239, 68, 68, 0.3);
            box-shadow: 0 12px 40px rgba(239, 68, 68, 0.1);
        }

        .shop-image {
            position: relative;
            height: 140px;
            overflow: hidden;
        }

        .shop-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .shop-image-fallback {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ef4444, #dc2626);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
            font-weight: bold;
        }

        .shop-badges {
            position: absolute;
            top: 8px;
            right: 8px;
            display: flex;
            gap: 6px;
            flex-direction: column;
        }

        .verified-badge,
        .featured-badge,
        .status-badge {
            padding: 3px 6px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 600;
            backdrop-filter: blur(20px);
        }

        .verified-badge {
            background: rgba(34, 197, 94, 0.9);
            color: white;
        }

        .featured-badge {
            background: rgba(251, 191, 36, 0.9);
            color: white;
        }

        .status-badge.open {
            background: rgba(34, 197, 94, 0.9);
            color: white;
        }

        .status-badge.closed {
            background: rgba(107, 114, 128, 0.9);
            color: white;
        }

        .shop-info {
            padding: 16px;
        }

        .shop-name {
            font-size: 1.1rem;
            font-weight: bold;
            color: white;
            margin-bottom: 6px;
            line-height: 1.3;
        }

        .shop-description {
            color: rgba(255, 255, 255, 0.7);
            font-size: 13px;
            margin-bottom: 12px;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .shop-stats {
            display: flex;
            gap: 12px;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 3px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        .shop-categories {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .category-tag {
            padding: 3px 6px;
            background: rgba(239, 68, 68, 0.2);
            border-radius: 8px;
            font-size: 10px;
            color: rgba(255, 255, 255, 0.8);
        }

        .loading-placeholder {
            grid-column: 1 / -1;
            text-align: center;
            padding: 32px 24px;
            color: rgba(255, 255, 255, 0.7);
        }

        .loading-spinner {
            width: 32px;
            height: 32px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top-color: #ef4444;
            animation: spin 1s ease-in-out infinite;
            margin: 0 auto 12px;
        }

        /* Features section - Simplified */
        .features-section {
            padding: 60px 20px;
            position: relative;
        }

        .features-container {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }

        .features-title {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 12px;
        }

        .features-subtitle {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 32px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 24px;
            margin-top: 32px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .feature-card:hover {
            transform: translateY(-4px);
            border-color: rgba(239, 68, 68, 0.3);
            box-shadow: 0 12px 40px rgba(239, 68, 68, 0.1);
        }

        .feature-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #ef4444, #dc2626);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 16px;
            font-size: 20px;
        }

        .feature-title {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 12px;
        }

        .feature-description {
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.5;
            font-size: 14px;
        }

        /* Video section - Compact */
        .video-section {
            padding: 60px 20px;
            position: relative;
        }

        .video-container {
            max-width: 700px;
            margin: 0 auto;
            text-align: center;
        }

        .video-title {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 12px;
        }

        .video-subtitle {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 32px;
        }

        .video-embed {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .video-embed iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* Footer - Simplified */
        .footer {
            background: rgba(5, 5, 5, 0.9);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 40px 20px 16px;
        }

        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 32px;
        }

        .footer-section h3 {
            font-size: 1rem;
            font-weight: bold;
            margin-bottom: 16px;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section li {
            margin-bottom: 8px;
        }

        .footer-section a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            transition: color 0.3s ease;
            font-size: 14px;
        }

        .footer-section a:hover {
            color: #ef4444;
        }

        .social-links {
            display: flex;
            gap: 12px;
            margin-top: 16px;
        }

        .social-link {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.7);
            transition: all 0.3s ease;
            backdrop-filter: blur(20px);
        }

        .social-link:hover {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 16px;
            margin-top: 32px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.5);
            font-size: 14px;
        }

        /* Mobile Responsive Design */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2.2rem;
            }
            
            .hero-subtitle {
                font-size: 1rem;
            }
            
            .search-section {
                padding: 24px 20px;
                margin: 24px 0;
            }
            
            .quick-actions {
                flex-direction: column;
                align-items: center;
                gap: 8px;
            }
            
            .btn-primary, .btn-secondary {
                width: 160px;
                text-align: center;
            }

            .featured-shops-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .features-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .nav-container {
                padding: 0 16px;
            }

            .logo-text {
                font-size: 20px;
            }

            .hero-section {
                padding: 90px 16px 30px;
                min-height: 70vh;
            }

            .featured-shops-section {
                padding: 30px 16px 40px;
            }

            .features-section {
                padding: 40px 16px;
            }

            .video-section {
                padding: 40px 16px;
            }
        }

        /* Animated particles */
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #ef4444;
            border-radius: 50%;
            opacity: 0;
            animation: particleFloat 6s infinite;
        }

        @keyframes particleFloat {
            0%, 100% { opacity: 0; transform: translateY(0px) translateX(0px); }
            50% { opacity: 0.6; transform: translateY(-100px) translateX(50px); }
        }

        .bg-particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Location prompt styles */
        .location-prompt {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            padding: 20px;
        }

        .location-prompt-content {
            background: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            max-width: 320px;
            width: 100%;
        }

        .location-prompt-content h3 {
            font-size: 1.2rem;
            margin-bottom: 8px;
            color: white;
        }

        .location-prompt-content p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            margin-bottom: 20px;
        }

        .location-prompt-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        /* Location toast styles */
        .location-toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9999;
            padding: 0 20px;
            width: 100%;
            max-width: 500px;
            pointer-events: none;
        }

        .location-toast-content {
            background: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: white;
            font-size: 14px;
            pointer-events: auto;
        }

        .location-toast-content button {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            cursor: pointer;
            padding: 4px;
            margin-left: 12px;
        }

        /* Global styles for smooth scrolling and transitions */
        html {
            scroll-behavior: smooth;
        }

        /* Hide scrollbars for mobile */
        @media (max-width: 768px) {
            .category-filters {
                -webkit-overflow-scrolling: auto;
            }
        }
    </style>
</head>
<body>
    <div class="animated-gradient">
        <!-- Background particles -->
        <div class="bg-particles" id="particles"></div>
        
        <!-- Navigation -->
        <nav class="nav-glass">
            <div class="nav-container">
                <div class="logo-section">
                    <div class="logo">K</div>
                    <span class="logo-text">Knoc</span>
                </div>
                <button class="btn-primary" onclick="toggleView()">
                    <span id="toggle-text">For Shops</span>
                </button>
            </div>
        </nav>

        <!-- Hero Section - Compact for Mobile -->
        <section class="hero-section">
            <div class="hero-content">
                <h1 class="hero-title">
                    <span id="hero-main">Knoc on</span>
                    <span class="gradient-text" id="hero-gradient">Shop's Doors</span>
                </h1>
                
                <p class="hero-subtitle" id="hero-subtitle">
                    Find exactly what you need from nearby shops instantly
                </p>

                <!-- Compact Search Section -->
                <div class="search-section">
                    <div class="search-label">
                        <svg width="14" height="14" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                        </svg>
                        <span>Search Local Shops</span>
                    </div>
                    
                    <!-- Search Container -->
                    <div class="search-container">
                        <div class="category-indicator" id="categoryIndicator">
                            Search for anything...
                        </div>
                        
                        <div class="search-box">
                            <input 
                                type="text" 
                                class="search-input" 
                                id="searchInput"
                                placeholder="Type name of any shop..."
                                oninput="handleSearch(this.value)"
                                onkeydown="handleKeyDown(event)"
                                onfocus="handleFocus()"
                                onblur="handleBlur()"
                            >
                            <div class="search-icon" id="searchIcon">
                                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                                </svg>
                            </div>
                        </div>

                        <div class="suggestions-dropdown" id="suggestionsDropdown">
                            <!-- Suggestions will be populated here -->
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 16px;">
                        <p style="font-size: 12px; color: rgba(255, 255, 255, 0.5);">
                            üí° Try: "Cafe", "Restaurants", "Name of any local shop"
                        </p>
                    </div>
                </div>

                <!-- Quick Action Buttons -->
                <div class="quick-actions">
                    <a href="https://play.google.com/store/apps/details?id=com.knoc.app" target="_blank" class="btn-primary" id="primary-cta">
                        Download App
                    </a>
                    <a href="#video" class="btn-secondary">
                        Watch Demo
                    </a>
                </div>
            </div>
        </section>

        <!-- Featured Shops Section - Right Below Search -->
        <section class="featured-shops-section" id="featured-shops-section">
            <div class="featured-container">
                <div class="section-header">
                    <h2 class="section-title">Featured Shops</h2>
                    <p class="section-subtitle">Discover popular shops in your area</p>
                    
                    <div class="category-filters" id="category-filters">
                        <!-- Categories will be populated dynamically -->
                        <div class="loading-spinner" style="width: 20px; height: 20px; margin: 0 auto;"></div>
                    </div>
                </div>
                
                <div class="featured-shops-grid" id="featured-shops-grid">
                    <!-- Shop cards will be populated here -->
                    <div class="loading-placeholder">
                        <div class="loading-spinner"></div>
                        <p>Loading featured shops...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section class="features-section">
            <div class="features-container">
                <h2 class="features-title" id="features-title">How It Works</h2>
                <p class="features-subtitle" id="features-subtitle">
                    Connect with local businesses in three simple steps
                </p>

                <div class="features-grid" id="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">üîç</div>
                        <h3 class="feature-title">Instant Search</h3>
                        <p class="feature-description">Find any product in nearby stores with intelligent search that understands shop names and products</p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">üí¨</div>
                        <h3 class="feature-title">Direct Communication</h3>
                        <p class="feature-description">Chat with store owners, share product images, and get real-time responses</p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">üìç</div>
                        <h3 class="feature-title">Location Based</h3>
                        <p class="feature-description">Discover shops and products exactly where you are, from your neighborhood to nearby areas</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Video Section -->
        <section class="video-section" id="video">
            <div class="video-container">
                <h2 class="video-title">See Knoc in Action</h2>
                <p class="video-subtitle">Watch how easily you can find products and connect with shops near you</p>
                
                <div class="video-embed">
                    <iframe 
                        src="https://www.youtube.com/embed/x13KftlfDwc" 
                        title="YouTube video player" 
                        frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen>
                    </iframe>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-container">
                <div class="footer-section">
                    <div class="logo-section">
                        <div class="logo">K</div>
                        <span class="logo-text">Knoc</span>
                    </div>
                    <p style="color: rgba(255, 255, 255, 0.7); margin: 16px 0; max-width: 250px; font-size: 14px;">
                        Connecting neighborhood stores with local customers for instant product discovery.
                    </p>
                    <div class="social-links">
                        <a href="https://youtube.com/@knoc-knoc?si=S7SYD9A8QT3zfVJ9" target="_blank" class="social-link">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                            </svg>
                        </a>
                        <a href="https://www.instagram.com/knocfind?igsh=dm5rZjloMjFjN2M4" target="_blank" class="social-link">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 5.838a6.162 6.162 0 1 0 0 12.324 6.162 6.162 0 0 0 0-12.324zM12 16a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm6.406-11.845a1.44 1.44 0 1 0 0 2.881 1.44 1.44 0 0 0 0-2.881z"/>
                            </svg>
                        </a>
                        <a href="mailto:contact@knoc.in" class="social-link">
                            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                            </svg>
                        </a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="#hero">Home</a></li>
                        <li><a href="#featured-shops-section">Featured Shops</a></li>
                        <li><a href="#video">Demo</a></li>
                        <li><a href="#" onclick="showPrivacyPolicy()">Privacy Policy</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Get Started</h3>
                    <ul>
                        <li><a href="https://play.google.com/store/apps/details?id=com.knoc.app" target="_blank">Download App</a></li>
                        <li><a href="https://www.knoc.in/" target="_blank">Register Your Shop</a></li>
                        <li><a href="#video">How It Works</a></li>
                        <li><a href="mailto:contact@knoc.in">Support</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 Knoc. All rights reserved. | Connecting neighborhoods, one search at a time.</p>
            </div>
        </footer>
    </div>

    <!-- Privacy Policy Modal -->
    <div id="privacyModal" style="display: none; position: fixed; inset: 0; background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(8px); z-index: 9999; overflow-y: auto;">
        <div style="min-height: 100vh; padding: 32px 16px; display: flex; align-items: center; justify-content: center;">
            <div style="max-width: 800px; width: 100%; background: rgba(20, 20, 20, 0.95); backdrop-filter: blur(30px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 24px; padding: 48px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px;">
                    <h2 style="font-size: 2rem; font-weight: bold; color: white;">Privacy Policy</h2>
                    <button onclick="hidePrivacyPolicy()" style="background: none; border: none; color: rgba(255, 255, 255, 0.7); cursor: pointer; padding: 8px;">
                        <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
                
                <p style="color: #ef4444; font-weight: 500; margin-bottom: 32px;">Effective Date: February 13, 2025</p>
                
                <div style="color: rgba(255, 255, 255, 0.8); line-height: 1.6; space-y: 24px;">
                    <section style="margin-bottom: 32px;">
                        <h3 style="font-size: 1.25rem; font-weight: 600; color: white; margin-bottom: 16px;">Introduction</h3>
                        <p>Knoc is a platform that connects users with shops around them. Users can submit product inquiries, and shops can respond to those inquiries. The app allows shops to register and provide their details, including their products and services.</p>
                    </section>
                    
                    <section style="margin-bottom: 32px;">
                        <h3 style="font-size: 1.25rem; font-weight: 600; color: white; margin-bottom: 16px;">Data Collection and Usage</h3>
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 24px; border-radius: 12px; margin-bottom: 16px;">
                            <h4 style="font-weight: 600; color: white; margin-bottom: 12px;">User Information We Collect:</h4>
                            <ul style="list-style: disc; padding-left: 20px;">
                                <li>Full Name</li>
                                <li>Email Address</li>
                                <li>Contact Number</li>
                                <li>Location (for product inquiries)</li>
                            </ul>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.05); padding: 24px; border-radius: 12px;">
                            <h4 style="font-weight: 600; color: white; margin-bottom: 12px;">Shop Information We Collect:</h4>
                            <ul style="list-style: disc; padding-left: 20px;">
                                <li>Shop Name</li>
                                <li>Shop Images</li>
                                <li>Business Address</li>
                                <li>Owner's Name</li>
                                <li>Verification Photos</li>
                            </ul>
                        </div>
                    </section>
                    
                    <section style="background: linear-gradient(135deg, #ef4444, #dc2626); padding: 32px; border-radius: 12px; color: white;">
                        <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 16px;">Contact Us</h3>
                        <p style="margin-bottom: 12px;">If you have any questions about our privacy policy, please contact us at:</p>
                        <a href="mailto:contact@knoc.in" style="color: white; text-decoration: underline;">contact@knoc.in</a>
                    </section>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let currentView = 'user'; // 'user' or 'business'
        let isLoading = false;
        let suggestions = [];
        let selectedIndex = -1;
        let searchTimeout;
        let featuredShops = [];
        let currentLocation = null;
        
        // Location handling functions
        const locationHandler = {
            state: {
                hasLocation: false,
                locationDenied: false,
                lastLocation: null,
                permissionStatus: null
            },

            // Check if the browser supports geolocation
            isSupported() {
                return 'geolocation' in navigator;
            },

            // Check if permissions API is supported
            hasPermissionsAPI() {
                return 'permissions' in navigator;
            },

            // Get current permission status
            async checkPermissionStatus() {
                if (!this.hasPermissionsAPI()) return null;
                
                try {
                    const result = await navigator.permissions.query({ name: 'geolocation' });
                    this.state.permissionStatus = result.state;
                    return result.state;
                } catch (error) {
                    console.warn('Permission check failed:', error);
                    return null;
                }
            },

            // Request location with custom UI
            async requestLocation(showPrompt = true) {
                if (!this.isSupported()) {
                    console.warn('Geolocation is not supported');
                    return null;
                }

                // Check if we already have location permission
                const permissionStatus = await this.checkPermissionStatus();
                
                if (permissionStatus === 'denied') {
                    this.state.locationDenied = true;
                    this.showLocationError('blocked');
                    return null;
                }

                // Show custom prompt if needed
                if (showPrompt && permissionStatus !== 'granted') {
                    const shouldProceed = await this.showLocationPrompt();
                    if (!shouldProceed) {
                        this.showLocationError('denied');
                        return null;
                    }
                }

                try {
                    const position = await new Promise((resolve, reject) => {
                        navigator.geolocation.getCurrentPosition(
                            resolve,
                            reject,
                            {
                                enableHighAccuracy: true,
                                timeout: 5000,
                                maximumAge: 300000 // 5 minutes
                            }
                        );
                    });

                    this.state.hasLocation = true;
                    this.state.locationDenied = false;
                    this.state.lastLocation = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude,
                        accuracy: position.coords.accuracy,
                        timestamp: position.timestamp
                    };

                    // Store in sessionStorage
                    sessionStorage.setItem('userLocation', JSON.stringify(this.state.lastLocation));
                    
                    return this.state.lastLocation;

                } catch (error) {
                    this.handleLocationError(error);
                    return null;
                }
            },

            // Show custom location prompt
            async showLocationPrompt() {
                return new Promise(resolve => {
                    const promptDiv = document.createElement('div');
                    promptDiv.className = 'location-prompt';
                    promptDiv.innerHTML = `
                        <div class="location-prompt-content">
                            <div style="font-size: 24px; margin-bottom: 16px;">üìç</div>
                            <h3>Enable Location Services?</h3>
                            <p>This helps us show nearby shops and more accurate results.</p>
                            <div class="location-prompt-buttons">
                                <button class="btn-secondary" onclick="this.closest('.location-prompt').remove(); locationHandler.resolvePrompt(false);">
                                    Not Now
                                </button>
                                <button class="btn-primary" onclick="this.closest('.location-prompt').remove(); locationHandler.resolvePrompt(true);">
                                    Enable
                                </button>
                            </div>
                        </div>
                    `;

                    document.body.appendChild(promptDiv);
                    this.promptResolve = resolve;
                });
            },

            // Resolve the prompt
            resolvePrompt(value) {
                if (this.promptResolve) {
                    this.promptResolve(value);
                    this.promptResolve = null;
                }
            },

            // Handle location errors
            handleLocationError(error) {
                let errorType;
                switch (error.code) {
                    case error.PERMISSION_DENIED:
                        errorType = 'blocked';
                        this.state.locationDenied = true;
                        break;
                    case error.POSITION_UNAVAILABLE:
                        errorType = 'unavailable';
                        break;
                    case error.TIMEOUT:
                        errorType = 'timeout';
                        break;
                    default:
                        errorType = 'error';
                }
                this.showLocationError(errorType);
            },

            // Show location error message
            showLocationError(type) {
                const messages = {
                    blocked: 'Location access is blocked. Please enable it in your browser settings to see nearby shops.',
                    denied: 'Location access was denied. You can still use the app, but results may be less accurate.',
                    unavailable: 'Could not determine your location. Please try again later.',
                    timeout: 'Location request timed out. Please try again.',
                    error: 'An error occurred while getting your location.'
                };

                const message = messages[type] || messages.error;
                
                // Show error toast
                const toast = document.createElement('div');
                toast.className = 'location-toast';
                toast.innerHTML = `
                    <div class="location-toast-content">
                        <span>${message}</span>
                        <button onclick="this.parentElement.parentElement.remove()">‚úï</button>
                    </div>
                `;
                document.body.appendChild(toast);
                setTimeout(() => toast.remove(), 5000);
            }
        };

        // Enhanced categories with more keywords
        const categories = {
            food: {
                keywords: ['food', 'restaurant', 'pizza', 'burger', 'cafe', 'bakery', 'grocery', 'fruits', 'vegetables', 'meat', 'dairy', 'snacks', 'beverages', 'dining', 'kitchen', 'cooking', 'recipe', 'meal', 'lunch', 'dinner', 'breakfast', 'delight', 'annapurna', 'hotel', 'sweet', 'tiffin', 'biryani', 'dosa', 'idli', 'curry', 'roti', 'naan', 'samosa', 'chaat', 'ice cream', 'juice', 'tea', 'coffee'],
                name: 'üçï Food & Dining',
                color: '#ff6b6b'
            },
            fashion: {
                keywords: ['fashion', 'clothing', 'clothes', 'boutique', 'apparel', 'dress', 'shirt', 'jeans', 'shoes', 'accessories', 'jewelry', 'bag', 'style', 'designer', 'brand', 'outfit', 'wardrobe', 'trendy', 'casual', 'formal', 'footwear', 'handbag', 'saree', 'mens', 'women', 'kids', 'cotton', 'silk', 'wedding', 'party', 'ethnic', 'western', 'kurti', 'lehnga', 'suit', 'wear', 'collection'],
                name: 'üëó Fashion & Style',
                color: '#ff6b9d'
            },
            electronics: {
                keywords: ['electronics', 'mobile', 'phone', 'laptop', 'computer', 'tablet', 'tv', 'gadget', 'tech', 'digital', 'smart', 'device', 'camera', 'headphones', 'speaker', 'gaming', 'software', 'hardware', 'iphone', 'android', 'samsung', 'apple', 'repair', 'accessories', 'charger', 'battery', 'memory', 'storage'],
                name: 'üì± Electronics & Tech',
                color: '#4ecdc4'
            },
            medical: {
                keywords: ['medical', 'pharmacy', 'hospital', 'clinic', 'doctor', 'medicine', 'health', 'wellness', 'drugstore', 'chemist', 'dental', 'healthcare', 'treatment', 'therapy', 'surgery', 'emergency', 'ambulance', 'nurse', 'patient', 'diagnosis', 'ayurvedic', 'homeopathic', 'tablets', 'syrup', 'injection', 'bandage', 'first aid'],
                name: 'üè• Medical & Health',
                color: '#ff4757'
            },
            beauty: {
                keywords: ['beauty', 'salon', 'spa', 'cosmetics', 'makeup', 'hair', 'skin', 'nail', 'facial', 'massage', 'parlour', 'grooming', 'barber', 'styling', 'treatment', 'cream', 'lotion', 'shampoo', 'conditioner', 'perfume', 'lipstick', 'foundation'],
                name: 'üíÑ Beauty & Care',
                color: '#ffa726'
            },
            home: {
                keywords: ['home', 'furniture', 'decor', 'interior', 'kitchen', 'bedroom', 'living', 'dining', 'appliances', 'electronics', 'sofa', 'bed', 'table', 'chair', 'cupboard', 'wardrobe', 'lights', 'curtains', 'carpet', 'paint', 'tiles', 'hardware', 'tools'],
                name: 'üè† Home & Living',
                color: '#26a69a'
            }
        };

        // Initialize particles
        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 15; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                container.appendChild(particle);
            }
        }

        // Toggle between user and business view
        function toggleView() {
            currentView = currentView === 'user' ? 'business' : 'user';
            updateView();
        }

        function updateView() {
            const toggleText = document.getElementById('toggle-text');
            const heroMain = document.getElementById('hero-main');
            const heroGradient = document.getElementById('hero-gradient');
            const heroSubtitle = document.getElementById('hero-subtitle');
            const primaryCta = document.getElementById('primary-cta');
            const featuresTitle = document.getElementById('features-title');
            const featuresSubtitle = document.getElementById('features-subtitle');
            const featuresGrid = document.getElementById('features-grid');

            if (currentView === 'business') {
                toggleText.textContent = 'For Users';
                heroMain.textContent = 'Know What Your';
                heroGradient.textContent = 'Neighbors Need';
                heroSubtitle.textContent = 'Grow your business by instantly connecting with local customers actively searching for your products.';
                primaryCta.textContent = 'Register Your Shop';
                primaryCta.href = 'https://www.knoc.in/';
                featuresTitle.textContent = 'Grow Your Business';
                featuresSubtitle.textContent = 'Transform local product searches into real sales opportunities';
                
                // Update features for business
                featuresGrid.innerHTML = `
                    <div class="feature-card">
                        <div class="feature-icon">üìä</div>
                        <h3 class="feature-title">Access Local Demand</h3>
                        <p class="feature-description">Know exactly what your neighbors are looking for and respond to real customer needs</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">‚ö°</div>
                        <h3 class="feature-title">Instant Inquiries</h3>
                        <p class="feature-description">Receive product inquiries instantly and connect with customers actively searching for your products</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üìà</div>
                        <h3 class="feature-title">Grow Your Business</h3>
                        <p class="feature-description">Turn local searches into sales opportunities and build a loyal customer base in your area</p>
                    </div>
                `;
            } else {
                toggleText.textContent = 'For Shops';
                heroMain.textContent = 'Knoc on';
                heroGradient.textContent = 'Shop\'s Doors';
                heroSubtitle.textContent = 'Find exactly what you need from nearby shops instantly';
                primaryCta.textContent = 'Download App';
                primaryCta.href = 'https://play.google.com/store/apps/details?id=com.knoc.app';
                featuresTitle.textContent = 'How It Works';
                featuresSubtitle.textContent = 'Connect with local businesses in three simple steps';
                
                // Update features for users
                featuresGrid.innerHTML = `
                    <div class="feature-card">
                        <div class="feature-icon">üîç</div>
                        <h3 class="feature-title">Instant Search</h3>
                        <p class="feature-description">Find any product in nearby stores with intelligent search that understands shop names and products</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üí¨</div>
                        <h3 class="feature-title">Direct Communication</h3>
                        <p class="feature-description">Chat with store owners, share product images, and get real-time responses</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üìç</div>
                        <h3 class="feature-title">Location Based</h3>
                        <p class="feature-description">Discover shops and products exactly where you are, from your neighborhood to nearby areas</p>
                    </div>
                `;
            }
        }

        // Detect category from search query
        function detectCategory(query) {
            const lowerQuery = query.toLowerCase();
            
            for (const [category, config] of Object.entries(categories)) {
                if (config.keywords.some(keyword => 
                    lowerQuery.includes(keyword) || 
                    keyword.includes(lowerQuery)
                )) {
                    return category;
                }
            }
            
            return 'default';
        }

        // Update category indicator
        function updateCategoryIndicator(category) {
            const indicator = document.getElementById('categoryIndicator');
            
            if (category === 'default') {
                indicator.classList.remove('active');
                indicator.textContent = 'Search for anything...';
            } else {
                indicator.textContent = categories[category].name;
                indicator.classList.add('active');
                indicator.style.background = `rgba(${hexToRgb(categories[category].color)}, 0.2)`;
            }
        }

        // Convert hex to RGB
        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? 
                `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}` : 
                '239, 68, 68';
        }

        // Search functionality
        async function searchShops(query) {
            if (query.length < 2) {
                suggestions = [];
                hideSuggestions();
                return;
            }

            isLoading = true;
            updateSearchIcon();
            showTypingIndicator();
            
            try {
                const response = await fetch(
                    `https://rtwtkapynafirwixyeal.supabase.co/functions/v1/shop-search?q=${encodeURIComponent(query)}`
                );
                
                if (!response.ok) {
                    throw new Error('Failed to search shops');
                }
                
                const data = await response.json();
                suggestions = data.shops || [];
                showSuggestions();
            } catch (error) {
                console.error('Search error:', error);
                suggestions = [];
                hideSuggestions();
            } finally {
                isLoading = false;
                updateSearchIcon();
            }
        }

        // Handle search input
        function handleSearch(value) {
            clearTimeout(searchTimeout);
            
            // Update category
            const detectedCategory = detectCategory(value);
            updateCategoryIndicator(detectedCategory);
            
            if (value.trim()) {
                searchTimeout = setTimeout(() => {
                    searchShops(value.trim());
                }, 300);
            } else {
                suggestions = [];
                hideSuggestions();
                updateCategoryIndicator('default');
            }
        }

        // Handle keyboard navigation
        function handleKeyDown(event) {
            const dropdown = document.getElementById('suggestionsDropdown');
            if (!dropdown.classList.contains('show') || suggestions.length === 0) return;

            switch (event.key) {
                case 'ArrowDown':
                    event.preventDefault();
                    selectedIndex = selectedIndex < suggestions.length - 1 ? selectedIndex + 1 : selectedIndex;
                    updateSelection();
                    break;
                case 'ArrowUp':
                    event.preventDefault();
                    selectedIndex = selectedIndex > 0 ? selectedIndex - 1 : -1;
                    updateSelection();
                    break;
                case 'Enter':
                    event.preventDefault();
                    if (selectedIndex >= 0) {
                        selectShop(suggestions[selectedIndex]);
                    }
                    break;
                case 'Escape':
                    hideSuggestions();
                    selectedIndex = -1;
                    break;
            }
        }

        // Handle focus
        function handleFocus() {
            if (suggestions.length > 0) {
                showSuggestions();
            }
        }

        // Handle blur
        function handleBlur() {
            // Delay hiding to allow clicking on suggestions
            setTimeout(() => {
                hideSuggestions();
                selectedIndex = -1;
            }, 200);
        }

        // Update search icon
        function updateSearchIcon() {
            const icon = document.getElementById('searchIcon');
            if (isLoading) {
                icon.innerHTML = `
                    <svg width="20" height="20" class="animate-spin" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                `;
                icon.style.animation = 'spin 1s linear infinite';
            } else {
                icon.innerHTML = `
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                `;
                icon.style.animation = 'none';
            }
        }

        // Show typing indicator
        function showTypingIndicator() {
            const dropdown = document.getElementById('suggestionsDropdown');
            dropdown.innerHTML = `
                <div class="typing-indicator">
                    <span>Searching</span>
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
            `;
            dropdown.classList.add('show');
        }

        // Show suggestions
        function showSuggestions() {
            const dropdown = document.getElementById('suggestionsDropdown');
            
            if (suggestions.length === 0) {
                dropdown.innerHTML = `
                    <div style="padding: 32px 20px; text-align: center;">
                        <svg width="48" height="48" style="margin: 0 auto 12px; color: rgba(255, 255, 255, 0.3);" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                        </svg>
                        <p style="font-size: 16px; font-weight: 600; color: rgba(255, 255, 255, 0.8); margin-bottom: 6px;">No shops found</p>
                        <p style="font-size: 12px; color: rgba(255, 255, 255, 0.5);">Try a different search term</p>
                    </div>
                `;
            } else {
                dropdown.innerHTML = `
                    <div style="padding: 8px 16px; font-size: 12px; font-weight: 500; color: rgba(255, 255, 255, 0.7); border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                        Found ${suggestions.length} shop${suggestions.length !== 1 ? 's' : ''}
                    </div>
                    ${suggestions.map((shop, index) => `
                        <div class="suggestion-item" onclick="selectShop(suggestions[${index}])">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div style="width: 40px; height: 40px; border-radius: 10px; overflow: hidden; background: rgba(255, 255, 255, 0.1); flex-shrink: 0;">
                                    ${shop.image ? 
                                        `<img src="${shop.image}" alt="${shop.name}" style="width: 100%; height: 100%; object-fit: cover;">` :
                                        `<div style="width: 100%; height: 100%; background: linear-gradient(135deg, #ef4444, #dc2626); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 14px;">${shop.name.charAt(0).toUpperCase()}</div>`
                                    }
                                </div>
                                <div style="flex: 1; min-width: 0;">
                                    <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 3px;">
                                        <h3 style="color: white; font-weight: 600; font-size: 14px; margin: 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${shop.name}</h3>
                                        ${shop.verified ? '<svg width="12" height="12" fill="#4f46e5" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>' : ''}
                                    </div>
                                    <p style="color: rgba(255, 255, 255, 0.6); font-size: 12px; margin: 0 0 6px 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${shop.description || 'No description available'}</p>
                                    <div style="display: flex; align-items: center; gap: 8px; font-size: 10px;">
                                        ${shop.rating > 0 ? `
                                            <div style="display: flex; align-items: center; gap: 2px;">
                                                <svg width="10" height="10" fill="#fbbf24" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>
                                                <span style="color: rgba(255, 255, 255, 0.8);">${shop.rating.toFixed(1)}</span>
                                            </div>
                                        ` : ''}
                                        <div style="padding: 1px 6px; border-radius: 8px; font-size: 9px; ${shop.isOpen ? 'background: rgba(34, 197, 94, 0.2); color: #4ade80;' : 'background: rgba(107, 114, 128, 0.2); color: #9ca3af;'}">
                                            ${shop.isOpen ? 'Open' : 'Closed'}
                                        </div>
                                    </div>
                                </div>
                                <div style="flex-shrink: 0;">
                                    <svg width="16" height="16" fill="none" stroke="rgba(255, 255, 255, 0.5)" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                `;
            }
            
            dropdown.classList.add('show');
        }

        // Hide suggestions
        function hideSuggestions() {
            const dropdown = document.getElementById('suggestionsDropdown');
            dropdown.classList.remove('show');
        }

        // Update selection
        function updateSelection() {
            const items = document.querySelectorAll('.suggestion-item');
            items.forEach((item, index) => {
                if (index === selectedIndex) {
                    item.classList.add('selected');
                } else {
                    item.classList.remove('selected');
                }
            });
        }

        // Select shop
        function selectShop(shop) {
            document.getElementById('searchInput').value = shop.name;
            hideSuggestions();
            selectedIndex = -1;
            
            // Construct the profile URL using the shop ID
            const profileUrl = `https://www.knoc.in/shopProfile.html?type=shop&shopId=${shop.id}`;
            window.open(profileUrl, '_blank');
        }

        // Featured Shops Functionality
        async function loadFeaturedShops() {
            try {
                // Check for cached location in sessionStorage
                const cachedLocation = sessionStorage.getItem('userLocation');
                if (cachedLocation) {
                    currentLocation = JSON.parse(cachedLocation);
                    await fetchFeaturedShops();
                    return;
                }

                // Request location with custom UI
                const location = await locationHandler.requestLocation();
                if (location) {
                    currentLocation = location;
                    await fetchFeaturedShops();
                } else {
                    // Load without location if denied or error
                    currentLocation = null;
                    await fetchFeaturedShops();
                }
            } catch (error) {
                console.error('Error loading featured shops:', error);
                await fetchFeaturedShops();
            }
        }

        // Fetch featured shops from API
        async function fetchFeaturedShops(category = null, page = 1) {
            try {
                let url = `https://rtwtkapynafirwixyeal.supabase.co/functions/v1/featured-shops?page=${page}&limit=6`;
                
                if (category) {
                    url += `&category=${encodeURIComponent(category)}`;
                }
                
                if (currentLocation) {
                    url += `&location=${currentLocation.lat},${currentLocation.lng}&radius=10`;
                }

                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error('Failed to fetch featured shops');
                }
                
                const data = await response.json();
                featuredShops = data.shops || [];
                
                // Display featured shops
                displayFeaturedShops(data);
                
                return data;
            } catch (error) {
                console.error('Error fetching featured shops:', error);
                displayFeaturedShopsError();
                return { shops: [], total: 0 };
            }
        }

        // Display featured shops in the UI
        function displayFeaturedShops(data) {
            const container = document.getElementById('featured-shops-grid');
            const categoryFilters = document.getElementById('category-filters');
            
            // Update category filters
            if (data.popularCategories && categoryFilters) {
                categoryFilters.innerHTML = `
                    <button class="category-filter active" onclick="filterFeaturedShops(null)">
                        All
                    </button>
                    ${data.popularCategories.slice(0, 6).map(cat => `
                        <button class="category-filter" onclick="filterFeaturedShops('${cat.category}')">
                            ${capitalizeFirst(cat.category)} (${cat.count})
                        </button>
                    `).join('')}
                `;
            }

            // Display shops
            if (data.shops.length === 0) {
                container.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 32px 20px;">
                        <div style="font-size: 32px; margin-bottom: 12px;">üè™</div>
                        <h3 style="font-size: 1.2rem; margin-bottom: 6px; color: white;">No featured shops found</h3>
                        <p style="color: rgba(255, 255, 255, 0.6); font-size: 14px;">Try adjusting your filters or check back later</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = data.shops.map(shop => `
                <div class="featured-shop-card" onclick="openShopProfile('${shop.id}')">
                    <div class="shop-image">
                        ${shop.image ? 
                            `<img src="${shop.image}" alt="${shop.name}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">` :
                            ''
                        }
                        <div class="shop-image-fallback" style="${shop.image ? 'display: none;' : 'display: flex;'}">
                            <span>${shop.name.charAt(0).toUpperCase()}</span>
                        </div>
                        
                        <div class="shop-badges">
                            ${shop.verified ? '<div class="verified-badge">‚úì</div>' : ''}
                            ${shop.isFeatured ? '<div class="featured-badge">‚≠ê</div>' : ''}
                            <div class="status-badge ${shop.isOpen ? 'open' : 'closed'}">
                                ${shop.isOpen ? 'Open' : 'Closed'}
                            </div>
                        </div>
                    </div>
                    
                    <div class="shop-info">
                        <h3 class="shop-name">${shop.name}</h3>
                        <p class="shop-description">${shop.description || 'No description available'}</p>
                        
                        <div class="shop-stats">
                            ${shop.rating > 0 ? `
                                <div class="stat">
                                    <span class="star">‚≠ê</span>
                                    <span>${shop.rating.toFixed(1)}</span>
                                </div>
                            ` : ''}
                            
                            ${shop.followerCount > 0 ? `
                                <div class="stat">
                                    <span>üë•</span>
                                    <span>${shop.followerCount}</span>
                                </div>
                            ` : ''}
                            
                            ${shop.distance ? `
                                <div class="stat">
                                    <span>üìç</span>
                                    <span>${shop.distance} km</span>
                                </div>
                            ` : ''}
                        </div>
                        
                        ${shop.categories.length > 0 ? `
                            <div class="shop-categories">
                                ${shop.categories.slice(0, 3).map(cat => `
                                    <span class="category-tag">${capitalizeFirst(cat)}</span>
                                `).join('')}
                                ${shop.categories.length > 3 ? `<span class="category-tag">+${shop.categories.length - 3}</span>` : ''}
                            </div>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        // Display error state for featured shops
        function displayFeaturedShopsError() {
            const container = document.getElementById('featured-shops-grid');
            const categoryFilters = document.getElementById('category-filters');
            
            categoryFilters.innerHTML = `
                <button class="category-filter active" onclick="loadFeaturedShops()">
                    Retry Loading
                </button>
            `;

            container.innerHTML = `
                <div style="grid-column: 1 / -1; text-align: center; padding: 32px 20px;">
                    <div style="font-size: 32px; margin-bottom: 12px;">üòî</div>
                    <h3 style="font-size: 1.2rem; margin-bottom: 6px; color: white;">Unable to load featured shops</h3>
                    <p style="color: rgba(255, 255, 255, 0.6); font-size: 14px; margin-bottom: 16px;">Please check your connection and try again</p>
                    <button class="btn-primary" onclick="loadFeaturedShops()" style="font-size: 14px; padding: 8px 16px;">
                        Retry
                    </button>
                </div>
            `;
        }

        // Filter featured shops by category
        async function filterFeaturedShops(category) {
            // Update active filter button
            document.querySelectorAll('.category-filter').forEach(btn => {
                btn.classList.remove('active');
            });
            
            event.target.classList.add('active');
            
            // Show loading state
            const container = document.getElementById('featured-shops-grid');
            container.innerHTML = `
                <div class="loading-placeholder">
                    <div class="loading-spinner"></div>
                    <p>Loading shops...</p>
                </div>
            `;
            
            // Fetch and display filtered shops
            await fetchFeaturedShops(category);
        }

        // Open shop profile
        function openShopProfile(shopId) {
            const profileUrl = `https://www.knoc.in/shopProfile.html?type=shop&shopId=${shopId}`;
            window.open(profileUrl, '_blank');
        }

        // Utility function to capitalize first letter
        function capitalizeFirst(str) {
            return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();
        }

        // Privacy policy functions
        function showPrivacyPolicy() {
            document.getElementById('privacyModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function hidePrivacyPolicy() {
            document.getElementById('privacyModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            createParticles();
            updateView();
            
            // Load featured shops after a short delay
            setTimeout(() => {
                loadFeaturedShops();
            }, 1000);
            
            // Add smooth scrolling to anchor links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth'
                        });
                    }
                });
            });

            // Add scroll animations
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            });

            document.querySelectorAll('.feature-card, .featured-shop-card').forEach(card => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(30px)';
                card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                observer.observe(card);
            });

            // Add parallax effect to background
            window.addEventListener('scroll', () => {
                const scrolled = window.pageYOffset;
                const particles = document.getElementById('particles');
                if (particles) {
                    particles.style.transform = `translateY(${scrolled * 0.2}px)`;
                }
            });
        });

        // Global functions for window access
        window.loadFeaturedShops = loadFeaturedShops;
        window.filterFeaturedShops = filterFeaturedShops;
        window.openShopProfile = openShopProfile;
    </script>
</body>
</html>
